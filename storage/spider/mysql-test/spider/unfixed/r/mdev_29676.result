#
# MDEV-29676 Dual thread hang in 'closing tables' and 'Waiting for table metadata lock' on Spider CREATE OR REPLACE TABLE
#
for master_1
for child2
for child3
CREATE SERVER srv FOREIGN DATA WRAPPER MYSQL OPTIONS (SOCKET "/home/ycp/source/mariadb-server/mdev-29676/build/mysql-test/var/tmp/mysqld.1.1.sock", DATABASE 'test',user 'root');
CREATE TABLE t (c INT) ENGINE=Spider COMMENT='WRAPPER "mysql", srv "srv",TABLE "t"';
SET @old_lock_wait_timeout=@@global.lock_wait_timeout;
SET GLOBAL lock_wait_timeout=1;
# UNFIXED: the bug is indicated by some timeout warnings here, and requires a commit like e34024e00ac
CREATE OR REPLACE TABLE t (c INT);
Warnings:
Error	1205	Lock wait timeout exceeded; try restarting transaction
Error	1205	Lock wait timeout exceeded; try restarting transaction
SET GLOBAL lock_wait_timeout=@old_lock_wait_timeout;
DROP TABLE t;
for master_1
for child2
for child3
